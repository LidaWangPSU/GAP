% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gap.function.final.R
\name{GAP_bayesian_prior}
\alias{GAP_bayesian_prior}
\title{Estimate GAP Bayesian Prior Parameters}
\usage{
GAP_bayesian_prior(input, alpha, p_thershold, random)
}
\arguments{
\item{input}{A data frame containing GWAS results with the following columns:
\itemize{
  \item snp: SNP identifier
  \item chr: Chromosome number
  \item pos: Genomic position (in base pairs)
  \item beta_01: Effect size for trait 1
  \item beta_12: Effect size for trait 2
  \item beta_cc: Effect size for the combined trait
  \item se_01: Standard error for beta_01
  \item se_12: Standard error for beta_12
  \item se_cc: Standard error for beta_cc
}}

\item{alpha}{A numeric value for the alpha parameter in the GAP model}

\item{random}{An integer specifying the number of random SNPs to include in the analysis}

\item{p_theshold}{A numeric value for the p-value threshold to define significant SNPs}
}
\value{
A list containing:
  \itemize{
    \item tau: A numeric vector of length 3 containing the estimated prior parameters
      (t1, t2, r) for the covariance matrix
    \item p: A numeric vector of length 4 containing the estimated prior probabilities
      for the four states (00, 01, 12, cc)
  }
}
\description{
Estimates the prior parameters for the GAP (Genetic Association with Pleiotropy)
model using a subset of significant and random SNPs.
}
\details{
This function:
\enumerate{
  \item Calculates p-values for each trait association
  \item Estimates the correlation between traits using non-significant SNPs
  \item Identifies independent loci for each trait using clumping
  \item Selects a subset of significant and random SNPs for parameter estimation
  \item Optimizes the GAP prior parameters using maximum likelihood
}
}
\examples{
# Example usage with simulated data
set.seed(123)
n_snps <- 1000
input_data <- data.frame(
  snp = paste0("rs", 1:n_snps),
  chr = sample(1:22, n_snps, replace = TRUE),
  pos = sample(1:100000000, n_snps),
  beta_01 = rnorm(n_snps, 0, 0.1),
  beta_12 = rnorm(n_snps, 0, 0.1),
  beta_cc = rnorm(n_snps, 0, 0.1),
  se_01 = rep(0.05, n_snps),
  se_12 = rep(0.05, n_snps),
  se_cc = rep(0.05, n_snps)
)

# Estimate prior parameters
prior_params <- GAP_bayesian_prior(input_data, alpha = 0.5, p_theshold = 5e-8, random = 100)
print(prior_params)

}
\seealso{
\code{\link{find_loci}}, \code{\link{GAP_prior_v2}}
}
