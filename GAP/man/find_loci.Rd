% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gap.function.final.R
\name{find_loci}
\alias{find_loci}
\title{Find Independent Loci in GWAS Data}
\usage{
find_loci(gwas)
}
\arguments{
\item{gwas}{A data frame containing GWAS results with the following columns:
\itemize{
  \item chr: Chromosome number
  \item pos: Genomic position (in base pairs)
  \item pval: P-value for association
}}
}
\value{
A data frame with the same structure as input \code{gwas}, but with
  an additional column \code{top} indicating whether each SNP represents
  an independent locus (TRUE) or is clumped with a more significant SNP (FALSE).
}
\description{
This function identifies independent loci from GWAS data by clumping SNPs
that are within a specified distance threshold (2Mb by default).
}
\details{
The function works by:
\enumerate{
  \item Sorting SNPs by p-value within each chromosome
  \item Marking the most significant SNP in each chromosome as a top locus
  \item For subsequent SNPs, checking if they are within 2Mb of any existing top locus
  \item If within distance, marking as clumped; otherwise, marking as new top locus
}
}
\examples{
# Example GWAS data
gwas_data <- data.frame(
  chr = c(1, 1, 1, 2, 2),
  pos = c(1000000, 1500000, 3000000, 500000, 2000000),
  pval = c(1e-8, 1e-6, 1e-7, 1e-9, 1e-5)
)

# Find independent loci
loci_result <- find_loci(gwas_data)
print(loci_result)

}
